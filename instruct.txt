python parse_padchestgr.py \
  --images_root data/padchestgr/PadChest_GR \
  --train_csv  data/padchestgr/train_final_separated.csv \
  --test_csv   data/padchestgr/test_final_separated.csv \
  --clip_model_type ViT-B/32

python parse_padchestgr_jpg.py
python parse_padchestgr_jpg_region.py

---------------------------------------------------------------


python train.py \
  --only_prefix \
  --data ./data/padchestgr/padchestgr_clip_ViT-B_32_train_COCO_INDEX.pkl \
  --out_dir ./padchestgr_train_tf_prefix/ \
  --mapping_type transformer --num_layers 8 \
  --prefix_length 40 --prefix_length_clip 40


python caption.py \
  --image /home/moha/Desktop/CLIP_prefix_caption/data/padchestgr/PadChest_GR/735368723157872649570294614574522487_9kxq6l.png \
  --weights ./padchestgr_train_tf_prefix/coco_prefix-009.pt  \
  --mapping_type transformer \
  --only_prefix \
  --prefix_length 40 \
  --prefix_length_clip 40 \
  --beam


-------------------------------------------

python train_one_epoch_and_validate.py \
  --train_pkl ./data/padchestgr/padchestgr_clip_ViT-B_32_train_COCO_INDEX.pkl \
  --val_pkl   ./data/padchestgr/padchestgr_clip_ViT-B_32_test_COCO_INDEX.pkl \
  --out_dir   ./padchestgr_train_tf_prefix/ \
  --prefix coco_prefix \
  --only_prefix \
  --mapping_type transformer \
  --num_layers 8 \
  --prefix_length 40 \
  --prefix_length_clip 40 \
  --bs 40 \
  --beam \
  --epochs 10


python train_one_epoch_and_validate_region.py \
  --train_pkl ./data/padchestgr/padchestgr_clip_ViT-B_32_train_PADCHESTGR_REGION_INDEX.pkl \
  --val_pkl   ./data/padchestgr/padchestgr_clip_ViT-B_32_test_PADCHESTGR_REGION_INDEX.pkl \
  --out_dir   ./EXPERIMENTS/padchestgr_train_tf_prefix_jpg_region_155/ \
  --prefix padchestgr_prefix \
  --only_prefix \
  --mapping_type transformer \
  --num_layers 8 \
  --prefix_length 40 \
  --prefix_length_clip 40 \
  --bs 40 \
  --beam \
  --gen_len 15 \
  --epochs 10 \
  --use_mask
